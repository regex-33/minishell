#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <fcntl.h>
#include <string.h>

#define MAX_HOSTNAME_LENGTH 256
#define HOSTNAME_FILE "/proc/sys/kernel/hostname"

char *get_hostname() {
    char *hostname = (char *)malloc(MAX_HOSTNAME_LENGTH * sizeof(char));
    if (!hostname) {
        perror("Memory allocation failed");
        exit(EXIT_FAILURE);
    }

    int fd = open(HOSTNAME_FILE, O_RDONLY);
    if (fd == -1) {
        perror("Failed to open hostname file");
        free(hostname);
        exit(EXIT_FAILURE);
    }

    ssize_t bytes_read = read(fd, hostname, MAX_HOSTNAME_LENGTH);
    if (bytes_read == -1) {
        perror("Failed to read hostname");
        free(hostname);
        close(fd);
        exit(EXIT_FAILURE);
    }

    // Remove trailing newline character
    if (bytes_read > 0 && hostname[bytes_read - 1] == '\n') {
        hostname[bytes_read - 1] = '\0';
    }

    close(fd);

    return hostname;
}

int main() {
    char *hostname = get_hostname();
    printf("Hostname: %s\n", hostname);
    free(hostname);
    return 0;
}

